<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>State Data </title>

    <script src="http://www.openlayers.org/api/OpenLayers.js"></script>
    <script src="http://www.openstreetmap.org/openlayers/OpenStreetMap.js"></script>
 
    <script type="text/javascript">

   var map, selectControl, selectedFeature;



        function onPopupClose(evt) {
            selectControl.unselect(selectedFeature);
        }
        function onFeatureSelect(feature) {
            selectedFeature = feature;
            var str = "<table style=\'font-size: 1.5em\'><tr><th colspan=2>"+feature.layer.name+"</th></tr>";
            for(attr in feature.attributes){
             str = str + "<tr><td>"+attr+"</td><td>"+feature.attributes[attr]+"</td></tr>";
            };
            str = str + "</table>"
            popup = new OpenLayers.Popup.FramedCloud("chicken", 
                                     feature.geometry.getBounds().getCenterLonLat(),
                                     null,
                                     "<div style=\'font-size:.5em\'>"+str+"</div>",
                                     null, true, onPopupClose);
            feature.popup = popup;
            map.addPopup(popup);
        }
        function onFeatureUnselect(feature) {
            map.removePopup(feature.popup);
            feature.popup.destroy();
            feature.popup = null;
        }    

   function init(){
      var options = {
       projection: new OpenLayers.Projection("EPSG:4326"),
       controls: [new OpenLayers.Control.Navigation(),
                  new OpenLayers.Control.PanZoomBar(),
                  new OpenLayers.Control.LayerSwitcher(),
                  new OpenLayers.Control.Permalink(),
                  new OpenLayers.Control.ScaleLine(),
                  new OpenLayers.Control.MousePosition() ]
      };


      map = new OpenLayers.Map("map", options);
      
      var mapnik = new OpenLayers.Layer.OSM.Mapnik("OpenStreetMap"); 
      map.addLayer(mapnik);
 
        var States = new OpenLayers.Layer.Vector("States",{
      projection: "EPSG:4326",
      protocol: new OpenLayers.Protocol.HTTP({
                    	url: "States.gml",
                    	format: new OpenLayers.Format.GML()
                }),
       strategies: [new OpenLayers.Strategy.Fixed()],
			styleMap: new OpenLayers.StyleMap({'pointRadius': '${Murder}',
'fillColor': '${color}',
'strokeColor': 'black',
'fillOpacity': '0.4'
})
  
       });

      map.addLayer(States);


 


     selectControl = new OpenLayers.Control.SelectFeature(
                [States],
                {onSelect: onFeatureSelect, onUnselect: onFeatureUnselect}
            );
            
            map.addControl(selectControl);
            selectControl.activate();

map.zoomToExtent(
      new OpenLayers.Bounds(
      -127.25,27.8744,-68.9801,49.25
      ).transform(map.projection, new OpenLayers.Projection("EPSG:900913"))
      );

};

        function showStatus(text) {
            document.getElementById("status").innerHTML = text;            
        }

        </script>
    </head>
    <body onload="init()">
        <h1 id="title">State Data</h1>
        <div id="map" style="height:600px;width:600px" ></div>
        <div id="status"></div>
    </body>
</html>

